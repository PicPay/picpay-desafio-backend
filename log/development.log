Started POST "/users" for 127.0.0.1 at 2021-06-12 04:13:44 -0300
  [1m[35m (3.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate RAILS_ENV=development

You have 2 pending migrations:

20210612064900_create_users.rb
20210612065130_create_wallets.rb


):
  
activerecord (6.1.3.2) lib/active_record/migration.rb:625:in `check_pending!'
activerecord (6.1.3.2) lib/active_record/migration.rb:590:in `block (2 levels) in call'
activesupport (6.1.3.2) lib/active_support/evented_file_update_checker.rb:59:in `execute'
activerecord (6.1.3.2) lib/active_record/migration.rb:595:in `block in call'
activerecord (6.1.3.2) lib/active_record/migration.rb:587:in `synchronize'
activerecord (6.1.3.2) lib/active_record/migration.rb:587:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.1.3.2) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/debug_exceptions.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.1.3.2) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.1.3.2) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/static.rb:24:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/host_authorization.rb:98:in `call'
railties (6.1.3.2) lib/rails/engine.rb:539:in `call'
puma (5.3.2) lib/puma/configuration.rb:249:in `call'
puma (5.3.2) lib/puma/request.rb:77:in `block in handle_request'
puma (5.3.2) lib/puma/thread_pool.rb:338:in `with_force_shutdown'
puma (5.3.2) lib/puma/request.rb:76:in `handle_request'
puma (5.3.2) lib/puma/server.rb:438:in `process_client'
puma (5.3.2) lib/puma/thread_pool.rb:145:in `block in spawn_thread'
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20210612064900)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "ssn" varchar, "email" varchar, "password_digest" varchar, "kind" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20210612064900"]]
  [1m[36mTRANSACTION (11.8ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateWallets (20210612065130)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer NOT NULL, "balance" float, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_732f6628c4"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_wallets_on_user_id" ON "wallets" ("user_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20210612065130"]]
  [1m[36mTRANSACTION (5.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.7ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-06-12 07:14:01.280582"], ["updated_at", "2021-06-12 07:14:01.280582"]]
  [1m[36mTRANSACTION (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:14:09 -0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NameError (undefined local variable or method `has_secure_password' for UsersController:Class):
  
app/controllers/users_controller.rb:2:in `<class:UsersController>'
app/controllers/users_controller.rb:1:in `<main>'
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:15:10 -0300
  
NameError (undefined local variable or method `has_secure_password' for UsersController:Class):
  
app/controllers/users_controller.rb:2:in `<class:UsersController>'
app/controllers/users_controller.rb:1:in `<main>'
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password':'123456', 'kind':'shopkeeper' }
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:15:50 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NameError (undefined local variable or method `has_secure_password' for UsersController:Class):
  
app/controllers/users_controller.rb:2:in `<class:UsersController>'
app/controllers/users_controller.rb:1:in `<main>'
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:16:13 -0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }
  
ActionDispatch::Http::Parameters::ParseError (809: unexpected token at '{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }'):
  
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:96:in `rescue in parse_formatted_parameters'
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:92:in `parse_formatted_parameters'
actionpack (6.1.3.2) lib/action_dispatch/http/request.rb:399:in `block in POST'
rack (2.2.3) lib/rack/request.rb:69:in `fetch'
rack (2.2.3) lib/rack/request.rb:69:in `fetch_header'
actionpack (6.1.3.2) lib/action_dispatch/http/request.rb:398:in `POST'
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:55:in `parameters'
actionpack (6.1.3.2) lib/action_controller/metal/params_wrapper.rb:284:in `_wrapper_enabled?'
actionpack (6.1.3.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (6.1.3.2) lib/active_record/railties/controller_runtime.rb:27:in `process_action'
actionpack (6.1.3.2) lib/abstract_controller/base.rb:165:in `process'
actionpack (6.1.3.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (6.1.3.2) lib/action_controller/metal.rb:254:in `dispatch'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:33:in `serve'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:842:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.1.3.2) lib/active_record/migration.rb:601:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.1.3.2) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/debug_exceptions.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.1.3.2) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.1.3.2) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/static.rb:24:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/host_authorization.rb:98:in `call'
railties (6.1.3.2) lib/rails/engine.rb:539:in `call'
puma (5.3.2) lib/puma/configuration.rb:249:in `call'
puma (5.3.2) lib/puma/request.rb:77:in `block in handle_request'
puma (5.3.2) lib/puma/thread_pool.rb:338:in `with_force_shutdown'
puma (5.3.2) lib/puma/request.rb:76:in `handle_request'
puma (5.3.2) lib/puma/server.rb:438:in `process_client'
puma (5.3.2) lib/puma/thread_pool.rb:145:in `block in spawn_thread'
Error occurred while parsing request parameters.
Contents:

{'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:17:46 -0300
Error occurred while parsing request parameters.
Contents:

{'user': {'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }}
  
ActionDispatch::Http::Parameters::ParseError (809: unexpected token at '{'user': {'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }}'):
  
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:96:in `rescue in parse_formatted_parameters'
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:92:in `parse_formatted_parameters'
actionpack (6.1.3.2) lib/action_dispatch/http/request.rb:399:in `block in POST'
rack (2.2.3) lib/rack/request.rb:69:in `fetch'
rack (2.2.3) lib/rack/request.rb:69:in `fetch_header'
actionpack (6.1.3.2) lib/action_dispatch/http/request.rb:398:in `POST'
actionpack (6.1.3.2) lib/action_dispatch/http/parameters.rb:55:in `parameters'
actionpack (6.1.3.2) lib/action_controller/metal/params_wrapper.rb:284:in `_wrapper_enabled?'
actionpack (6.1.3.2) lib/action_controller/metal/params_wrapper.rb:248:in `process_action'
activerecord (6.1.3.2) lib/active_record/railties/controller_runtime.rb:27:in `process_action'
actionpack (6.1.3.2) lib/abstract_controller/base.rb:165:in `process'
actionpack (6.1.3.2) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (6.1.3.2) lib/action_controller/metal.rb:254:in `dispatch'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:33:in `serve'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.1.3.2) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.1.3.2) lib/action_dispatch/routing/route_set.rb:842:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.1.3.2) lib/active_record/migration.rb:601:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.1.3.2) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (6.1.3.2) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/debug_exceptions.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.1.3.2) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `block in tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:37:in `tagged'
activesupport (6.1.3.2) lib/active_support/tagged_logging.rb:99:in `tagged'
railties (6.1.3.2) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/request_id.rb:26:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.1.3.2) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/static.rb:24:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.1.3.2) lib/action_dispatch/middleware/host_authorization.rb:98:in `call'
railties (6.1.3.2) lib/rails/engine.rb:539:in `call'
puma (5.3.2) lib/puma/configuration.rb:249:in `call'
puma (5.3.2) lib/puma/request.rb:77:in `block in handle_request'
puma (5.3.2) lib/puma/thread_pool.rb:338:in `with_force_shutdown'
puma (5.3.2) lib/puma/request.rb:76:in `handle_request'
puma (5.3.2) lib/puma/server.rb:438:in `process_client'
puma (5.3.2) lib/puma/thread_pool.rb:145:in `block in spawn_thread'
Error occurred while parsing request parameters.
Contents:

{'user': {'name':'Nome Teste', 'email': 'teste@teste.com', 'ssn': '3894728934', 'password_digest':'123456', 'kind':'shopkeeper' }}
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:18:50 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname", "email"=>"email@email.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"shopkeeper"}}
[31mUnpermitted parameters: :password, :password_confirmation[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 422 Unprocessable Entity in 174ms (ActiveRecord: 20.3ms | Allocations: 15865)


  
ActiveRecord::RecordInvalid (Validation failed: Password can't be blank):
  
app/controllers/users_controller.rb:5:in `create'
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:19:18 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname", "email"=>"email@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"shopkeeper"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (2.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "ssn", "email", "password_digest", "kind", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "firstname"], ["ssn", "38947234"], ["email", "email@email.com"], ["password_digest", "123456"], ["kind", 0], ["created_at", "2021-06-12 07:19:18.964969"], ["updated_at", "2021-06-12 07:19:18.964969"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mWallet Create (0.4ms)[0m  [1m[32mINSERT INTO "wallets" ("user_id", "balance", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["user_id", 1], ["balance", 0.0], ["created_at", "2021-06-12 07:19:19.041395"], ["updated_at", "2021-06-12 07:19:19.041395"]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mTRANSACTION (9.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 500 Internal Server Error in 110ms (ActiveRecord: 14.3ms | Allocations: 16138)


  
NoMethodError (undefined method `email' for nil:NilClass):
  
app/controllers/users_controller.rb:6:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mWallet Load (1.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mWallet Load (0.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mWallet Destroy (0.4ms)[0m  [1m[31mDELETE FROM "wallets" WHERE "wallets"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = ?[0m  [["id", 1]]
  [1m[36mTRANSACTION (6.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mWallet Load (0.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" ORDER BY "wallets"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:21:50 -0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname", "email"=>"email@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"shopkeeper"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "ssn", "email", "password_digest", "kind", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "firstname"], ["ssn", "38947234"], ["email", "email@email.com"], ["password_digest", "123456"], ["kind", 0], ["created_at", "2021-06-12 07:21:50.657977"], ["updated_at", "2021-06-12 07:21:50.657977"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mWallet Create (0.4ms)[0m  [1m[32mINSERT INTO "wallets" ("user_id", "balance", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["user_id", 2], ["balance", 0.0], ["created_at", "2021-06-12 07:21:50.696247"], ["updated_at", "2021-06-12 07:21:50.696247"]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mTRANSACTION (6.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 201 Created in 77ms (Views: 0.4ms | ActiveRecord: 10.8ms | Allocations: 21293)


Started POST "/users" for 127.0.0.1 at 2021-06-12 04:22:08 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname", "email"=>"email@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"consumer"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 422 Unprocessable Entity in 122ms (ActiveRecord: 1.1ms | Allocations: 6134)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken, Ssn has already been taken):
  
app/controllers/users_controller.rb:5:in `create'
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:22:27 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname2", "email"=>"email2@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"consumer"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email2@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 422 Unprocessable Entity in 13ms (ActiveRecord: 0.7ms | Allocations: 3156)


  
ActiveRecord::RecordInvalid (Validation failed: Ssn has already been taken):
  
app/controllers/users_controller.rb:5:in `create'
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:22:41 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname2", "email"=>"email2@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"consumer"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email2@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "3827647823"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "ssn", "email", "password_digest", "kind", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "firstname2"], ["ssn", "3827647823"], ["email", "email2@email.com"], ["password_digest", "123456"], ["kind", 1], ["created_at", "2021-06-12 07:22:41.573790"], ["updated_at", "2021-06-12 07:22:41.573790"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mWallet Create (4.1ms)[0m  [1m[32mINSERT INTO "wallets" ("user_id", "balance", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["user_id", 3], ["balance", 0.0], ["created_at", "2021-06-12 07:22:41.582699"], ["updated_at", "2021-06-12 07:22:41.582699"]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mTRANSACTION (11.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 201 Created in 41ms (Views: 0.4ms | ActiveRecord: 17.5ms | Allocations: 7356)


  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/users/1" for 127.0.0.1 at 2021-06-12 04:56:10 -0300
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#update as JSON
  Parameters: {"user"=>{"name"=>"firstname1", "email"=>"email1@email.com"}, "id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:33:in `set_user'
Completed 404 Not Found in 13ms (ActiveRecord: 2.2ms | Allocations: 2331)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=1):
  
app/controllers/users_controller.rb:33:in `set_user'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT ?[0m  [["LIMIT", 1]]
Started PUT "/users/2" for 127.0.0.1 at 2021-06-12 04:56:32 -0300
Processing by UsersController#update as JSON
  Parameters: {"user"=>{"name"=>"firstname1", "email"=>"email1@email.com"}, "id"=>"2"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:33:in `set_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:21:in `update'
  [1m[36mUser Exists? (23.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? AND "users"."id" != ? LIMIT ?[0m  [["email", "email1@email.com"], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:21:in `update'
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? AND "users"."id" != ? LIMIT ?[0m  [["ssn", "38947234"], ["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:21:in `update'
  [1m[36mUser Update (7.2ms)[0m  [1m[33mUPDATE "users" SET "name" = ?, "email" = ?, "updated_at" = ? WHERE "users"."id" = ?[0m  [["name", "firstname1"], ["email", "email1@email.com"], ["updated_at", "2021-06-12 07:56:32.521248"], ["id", 2]]
  ↳ app/controllers/users_controller.rb:21:in `update'
  [1m[36mTRANSACTION (8.0ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:21:in `update'
Completed 200 OK in 236ms (Views: 0.4ms | ActiveRecord: 39.4ms | Allocations: 12735)


Started DELETE "/users/2" for 127.0.0.1 at 2021-06-12 04:57:35 -0300
Processing by UsersController#destroy as JSON
  Parameters: {"id"=>"2", "user"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:33:in `set_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `destroy'
  [1m[36mWallet Load (1.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."user_id" = ? LIMIT ?[0m  [["user_id", 2], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:11:in `destroy'
  [1m[36mWallet Destroy (0.9ms)[0m  [1m[31mDELETE FROM "wallets" WHERE "wallets"."id" = ?[0m  [["id", 2]]
  ↳ app/controllers/users_controller.rb:11:in `destroy'
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = ?[0m  [["id", 2]]
  ↳ app/controllers/users_controller.rb:11:in `destroy'
  [1m[36mTRANSACTION (6.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:11:in `destroy'
Completed 500 Internal Server Error in 70ms (ActiveRecord: 10.1ms | Allocations: 12337)


  
ArgumentError (Unrecognized status code :no_concent):
  
app/controllers/users_controller.rb:12:in `destroy'
Started POST "/users" for 127.0.0.1 at 2021-06-12 04:58:08 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"name"=>"firstname", "email"=>"email@email.com", "password_digest"=>"[FILTERED]", "ssn"=>"[FILTERED]", "kind"=>"shopkeeper"}}
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "email@email.com"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."ssn" = ? LIMIT ?[0m  [["ssn", "38947234"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "ssn", "email", "password_digest", "kind", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["name", "firstname"], ["ssn", "38947234"], ["email", "email@email.com"], ["password_digest", "123456"], ["kind", 0], ["created_at", "2021-06-12 07:58:08.552989"], ["updated_at", "2021-06-12 07:58:08.552989"]]
  ↳ app/controllers/users_controller.rb:5:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mWallet Create (0.4ms)[0m  [1m[32mINSERT INTO "wallets" ("user_id", "balance", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["user_id", 4], ["balance", 0.0], ["created_at", "2021-06-12 07:58:08.584570"], ["updated_at", "2021-06-12 07:58:08.584570"]]
  ↳ app/models/user.rb:15:in `create_default_wallet'
  [1m[36mTRANSACTION (7.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:5:in `create'
Completed 201 Created in 73ms (Views: 0.3ms | ActiveRecord: 14.2ms | Allocations: 15430)


